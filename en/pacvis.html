<!DOCTYPE html>
<html lang="en-us"
>
<head>
    <title>PacVis: visualize pacman local database - Farseerfc's Nest</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <meta name="theme-color" content="#6b5594">
    <meta name="msapplication-navbutton-color" content="#6b5594">
    <meta name="apple-mobile-web-app-status-bar-style" content="#6b5594">
    <link rel="manifest" href="/manifest.json">

<link rel="canonical" href="//farseerfc.me/en/pacvis.html">

        <meta name="author" content="farseerfc" />
        <meta name="keywords" content="python,pacvis,pacman,arch,linux,pacgraph" />
        <meta name="description" content="PacVis Motivation for PacVis I must admit that I love Arch Linux, largely because Arch Linux made me feel like I really own the whole system. In my Arch Linux system, I know clearly each package that I have installed and why I installed it. I can find which package ..." />

        <meta property="og:site_name" content="Farseerfc's Nest" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="PacVis: visualize pacman local database"/>
        <meta property="og:url" content="//farseerfc.me/en/pacvis.html"/>
        <meta property="og:description" content="PacVis Motivation for PacVis I must admit that I love Arch Linux, largely because Arch Linux made me feel like I really own the whole system. In my Arch Linux system, I know clearly each package that I have installed and why I installed it. I can find which package ..."/>
        <meta property="article:published_time" content="2016-07-31" />
            <meta property="article:section" content="tech" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="pacvis" />
            <meta property="article:tag" content="pacman" />
            <meta property="article:tag" content="arch" />
            <meta property="article:tag" content="linux" />
            <meta property="article:tag" content="pacgraph" />
            <meta property="article:author" content="farseerfc" />
        <meta property="og:image"
                  content="//farseerfc.me/en/pacvis.png"/>



    <!-- Bootstrap -->
        <link href="//farseerfc.me/en/../theme/css/bootstrap.min.css" rel="stylesheet">

    <link href="//farseerfc.me/en/../theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="//farseerfc.me/en/../theme/css/pygments/monokai.css" rel="stylesheet">
    <link href="//farseerfc.me/en/../theme/tipuesearch/tipuesearch.css" rel="stylesheet">
        <link href="//farseerfc.me/en/../theme/css/html4css1.css" rel="stylesheet">
    <link rel="stylesheet" href="//farseerfc.me/en/../theme/css/style.css" type="text/css"/>

        <link href="//farseerfc.me/en/feeds/atom.xml" type="application/atom+xml" rel="alternate"
              title="Farseerfc's Nest ATOM Feed"/>

        <link href="//farseerfc.me/en/../theme/css/material.min.css" rel="stylesheet">
        <link href="//farseerfc.me/en/../theme/css/ripples.css" rel="stylesheet">
</head>
<body>
<div style="display:none" id="title">PacVis: visualize pacman local database - Farseerfc's Nest</div>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
         <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="//farseerfc.me/en/" class="navbar-brand">
Farseerfc's Nest            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">

                    <li class="dropdown hidden-lg hidden-xl">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:void(0)">
                            <i class="mdi-action-translate"></i><span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="//farseerfc.me/">繁體</a></li>
                            <li><a href="//farseerfc.me/zhs/">简体</a></li>
                            <li class="active"><a href="//farseerfc.me/en/">English</a></li>
                            <li><a href="//farseerfc.me/jp/">日本語</a></li>
                        </ul>
                    </li>

                    <ul class="nav navbar-nav hidden-xs hidden-md hidden-sm">
                        <li><a href="//farseerfc.me/"><i class="mdi-action-translate"></i>繁體</a></li>
                        <li><a href="//farseerfc.me/zhs/"><i class="mdi-action-translate"></i>简体</a></li>
                        <li class="active"><a href="//farseerfc.me/en/"><i class="mdi-action-translate"></i>English</a></li>
                        <li><a href="//farseerfc.me/jp/"><i class="mdi-action-translate"></i>日本語</a></li>
                    </ul>

                    <li class="dropdown hidden-md hidden-lg hidden-xl">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:void(0)">
                            <i class="fa fa-user"></i><span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                             <li class=""><a href="//farseerfc.me/en/about.html"><i class="fa fa-user"></i>
                                 About
                              </a></li>
                        </ul>
                    </li>

                  <ul class="nav navbar-nav hidden-xs hidden-sm">
                     <li class=""><a href="//farseerfc.me/en/about.html"><i class="fa fa-user"></i>
                         About
                      </a></li>
                  </ul>
            </ul>

                <ul class="nav navbar-nav hidden-md hidden-lg hidden-xl">
                    <li class="dropdown hidden-md hidden-lg hidden-xl">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:void(0)">
                            <i class="fa fa-folder-o"></i><span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li >
                                <a href="//farseerfc.me/en/category/import.html"><i class="fa fa-folder-o"></i> Import</a>
                            </li>
                            <li >
                                <a href="//farseerfc.me/en/category/life.html"><i class="fa fa-folder-o"></i> Life</a>
                            </li>
                            <li class="active">
                                <a href="//farseerfc.me/en/category/tech.html"><i class="fa fa-folder-o"></i> Tech</a>
                            </li>
                        </ul>
                    </li>
                </ul>

                    <ul class="nav navbar-nav hidden-xs hidden-sm">
                        <li >
                            <a href="//farseerfc.me/en/category/import.html"><i class="fa fa-folder-o"></i> Import</a>
                        </li>
                        <li >
                            <a href="//farseerfc.me/en/category/life.html"><i class="fa fa-folder-o"></i> Life</a>
                        </li>
                        <li class="active">
                            <a href="//farseerfc.me/en/category/tech.html"><i class="fa fa-folder-o"></i> Tech</a>
                        </li>
                    </ul>



            <ul class="nav navbar-nav navbar-right hidden-sm hidden-md hidden-lg hidden-xl">
                <li class="dropdown hidden-md hidden-lg hidden-xl">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:void(0)">
                        <i class="fa fa-search"></i><span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                      <li><span>
                        <form class="navbar-search" action="/search.html">
                          <input type="text" class="search-query form-control col-lg-16" placeholder="Search" name="q" id="tipue_search_input" required>
                        </form></span>
                      </li>
                    </ul>
                </li>
            </ul>

            <ul class="nav navbar-right navbar-form hidden-xs">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query form-control col-lg-16" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
            </ul>

            <ul class="nav navbar-nav navbar-right hidden-xs">
              <li><a href="//farseerfc.me/en/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">All</span></a></li>
              <li><a href="//farseerfc.me/en/feeds/atom.xml" title="Atom feeds for all articles"><i class="fa fa-rss"></i></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container" style="min-height: 100%;height: auto !important;height: 100%;">
    <div class="row" style="padding-bottom:80px;padding-top:80px;">
        <div class="col-xl-21 col-lg-20 col-md-18">
            <div id="loading-block">
            <ol class="breadcrumb">
                <li><a href="//farseerfc.me/en/" title="Farseerfc's Nest"><i class="fa fa-home fa-lg"></i></a></li>
                <li><a href="//farseerfc.me/en/category/tech.html" title="tech">tech</a></li>
                <li class="active">PacVis: visualize pacman local database</li>
            </ol>
    <section id="content" class="article-content">
        <article>
            <header class="page-header jumbotron jumbotron-primary panel-primary" id="article-header">
                <div class="panel-heading">
                    <h1>
                        PacVis: visualize pacman local database
                        <a href="//farseerfc.me/en/pacvis.html"
                           rel="bookmark"
                           class="btn btn-primary btn-lg"
                           title="Permalink to PacVis: visualize pacman local database">
                           <i class="mdi-action-launch"></i>
                        </a>
                    </h1>
                </div>
                <div class="panel-body">
<div class="post-info">
    <span class="published">
        <time datetime="2016-07-31T03:52:00+09:00"><i class="fa fa-calendar"></i> Sun, 31 Jul 2016</time>
    </span>



<div class="btn-group translations">
<a href="javascript:void(0)" class="btn btn-primary dropdown-toggle" data-toggle="dropdown"><i class="mdi-action-translate"></i><span class="caret"></a>
<ul class="dropdown-menu">
<li class="active"><a href="//farseerfc.me/en/pacvis.html">English</a></li><li><a href="//farseerfc.me/en/../pacvis.html" class="translate">繁體</a></li><li><a href="//farseerfc.me/en/../zhs/pacvis.html" class="translate">简体</a></li></ul>
</div>

    <a onclick="$.get('//farseerfc.me/en/pacvis.rst.html', function(data){$('#source-code').html(data)});$('#article-content').toggle();$('#source-content').toggle();" class="btn btn-primary" title="Show source code of this page"><i class="fa fa-code"></i></a>
    <a href="//farseerfc.me/en/pacvis.pdf" class="btn btn-primary" title="Show pdf version of this page" target="_blank"><i class="fa fa-file-pdf-o"></i></a>
    <a href="//farseerfc.me/en/pacvis.png" class="btn btn-primary" title="Show captured png of this page" target="_blank""><i class="fa fa-file-photo-o"></i></a>

<small><span><a href="//farseerfc.me/en/pacvis.html#disqus_thread" class="btn btn-primary" data-disqus-identifier="pacvis" data-disqus-url="http://farseerfc.me/en/pacvis.html"><i class="fa fa-comments-o"></i></a></span></small><span class="btn-group">
	<a href="//farseerfc.me/en/tag/python.html" class="btn btn-primary btn-xs"><i class="fa fa-tag"></i> python</a>
	<a href="//farseerfc.me/en/tag/pacvis.html" class="btn btn-primary btn-xs"><i class="fa fa-tag"></i> pacvis</a>
	<a href="//farseerfc.me/en/tag/pacman.html" class="btn btn-primary btn-xs"><i class="fa fa-tag"></i> pacman</a>
	<a href="//farseerfc.me/en/tag/arch.html" class="btn btn-primary btn-xs"><i class="fa fa-tag"></i> arch</a>
	<a href="//farseerfc.me/en/tag/linux.html" class="btn btn-primary btn-xs"><i class="fa fa-tag"></i> linux</a>
	<a href="//farseerfc.me/en/tag/pacgraph.html" class="btn btn-primary btn-xs"><i class="fa fa-tag"></i> pacgraph</a>
</span>



</div><!-- /.post-info -->                </div>
            </header>

            <div class="entry-content jumbotron" id="article-content">
                    <div class="panel panel-default">
                        <div class="panel-heading">
Table of Contents                        </div>
                        <div class="panel-boy">
                        <div class="toc" id="">

<ul class="simple">
<li><a class="reference internal" href="#motivation-for-pacvis" id="id2">Motivation for PacVis</a></li>
<li><a class="reference internal" href="#predecessors-of-pacvis" id="id3">Predecessors of PacVis</a><ul>
<li><a class="reference internal" href="#pactree" id="id4">pactree</a></li>
<li><a class="reference internal" href="#pacgraph" id="id5">pacgraph</a></li>
</ul>
</li>
<li><a class="reference internal" href="#so-here-is-pacvis" id="id6">So here is PacVis</a></li>
<li><a class="reference internal" href="#the-legend-and-usage-of-pacvis" id="id7">The legend and usage of PacVis</a></li>
<li><a class="reference internal" href="#some-facts-you-can-learn-from-pacvis" id="id8">Some facts you can learn from PacVis</a><ul>
<li><a class="reference internal" href="#dependency-hierachy" id="id9">Dependency hierachy</a></li>
<li><a class="reference internal" href="#circular-dependencies" id="id10">Circular dependencies</a></li>
<li><a class="reference internal" href="#some-packages-don-t-have-dependency-relationship" id="id11">Some packages don't have dependency relationship</a></li>
<li><a class="reference internal" href="#linux-the-kernel-is-unimportant-if-we-only-look-at-dependencies" id="id12">Linux (the kernel) is unimportant, if we only look at dependencies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-future-of-pacvis" id="id13">The future of PacVis</a></li>
</ul>
</div>
                        </div>
                    </div>
                
<div class="panel panel-default">
<div class="panel-heading">
PacVis</div>
<div class="panel-body">
<img alt="Demo of PacVis" class="img-responsive" src="//farseerfc.me/en/images/pacvis-first.png"/>
</div>
</div>
<div class="section" id="motivation-for-pacvis">
<h2><a class="toc-backref" href="#id2">Motivation for PacVis</a></h2>
<p>I must admit that I love Arch Linux, largely because Arch Linux made me feel
like I really <strong>own</strong> the whole system. In my Arch Linux system, I know clearly
each package that I have installed and why I installed it. I can find which
package brings in a give file. A Debian/Fedora/openSUSE user with enough experience
may achieve this with their favorite package manager too, but they must overcome
a much higher complexity with their distro's fine-grinding packaging strategy.
Usually they have 3 to 10 times more packages than Arch Linux on a
similar setup. And with regard to packaging system, they must work with much more
details than Arch's simple PKGBUILD based packaging.</p>
<p>Every user who successfully installed Arch Linux should have learned that, after
the initial installation, you will only get a minimum setup. The most important
step in the installation guide on ArchWiki is a command
<code class="code">
pactrap /mnt base</code>
 , which will use <code class="code">
/mnt</code>
 as the filesystem root
and call <code class="code">
pacman -S base</code>
 inside that root to install the whole base
group. And that's basically all you will get after the install. The initial
system has nearly nothing. Everything you need will be installed afterwards,
manually by using <code class="code">
pacman</code>
. It is nothing unnecessary, only for <strong>your</strong> need.</p>
<p>But after using the system for a long time, there are unavoidably some packages
inside the system which are installed and used for awhile and abandoned.
They are like the old furnitures inside your house, taking space and covered by
ash. We have <code class="code">
pacman -Qtd</code>
 to help you find all packages that are
<strong>installed as dependency for other packages once but not needed for now</strong>
, but for those manually installed packages, we have no good tool but manually
checking them one by one.</p>
<p>So I was looking for a tool to help me understand the relations in my system.
In particular, I want a tool to help me do these things:</p>
<ol class="arabic simple">
<li>Find the packages that I installed manually but not needed now</li>
<li>Find those large and space-consuming packages</li>
<li>Understand th relationship between packages</li>
</ol>
<div class="figure">
<img alt="Android System Architecture" class="img-responsive" src="//farseerfc.me/en/images/Android-System-Architecture.jpg"/>
<p class="caption"><a class="reference external" href="https://en.wikipedia.org/wiki/Android_(operating_system)">Android System Architecture</a></p>
</div>
<p>About the last thing "relations between packages", I once saw the diagram of
<a class="reference external" href="https://en.wikipedia.org/wiki/Architecture_of_OS_X">macOS Architecture</a>
and Android System Architecture, and I was impressed by the layered hierarchy
in these diagrams. I was wondering since then that <em>is it possible to draw a
similar layered architecture diagram for modern Linux desktop</em> ?
Or will it be much different? I can find hierarchy diagram for Linux kernel or
Xorg graphic stack on Wikipedia or other sites, but I don't know such a diagram
for the whole distribution. And further I thought, can I <em>draw such diagram from
the dependency relationships between packages automatically</em>?</p>
</div>
<div class="section" id="predecessors-of-pacvis">
<h2><a class="toc-backref" href="#id3">Predecessors of PacVis</a></h2>
<p>Before working on PacVis, I have tried several similar tools. Some of them meet
some of my needs, but they all lack certain features that I considered important.
These tools became the prototype of PacVis, as they enlightened me of how PacVis
should be.</p>
<div class="section" id="pactree">
<h3><a class="toc-backref" href="#id4">pactree</a></h3>
<p>pactree started as an <a class="reference external" href="https://bbs.archlinux.org/viewtopic.php?id=51795">individual project</a>
, but now it is <a class="reference external" href="https://www.archlinux.org/pacman/pactree.8.html">part of pacman</a>.
From its manpage we can see that the output of pactree is a dependency tree
starting from a given package. By appending <code class="code">
--graph</code>
 parameter, pactree
can also output a diagram in <a class="reference external" href="http://www.graphviz.org/">dot</a> format,
then we can render this diagram using dot command:</p>
<div class="panel panel-default">
<div class="panel-heading">
<code class="code">
pactree pacvis-git -d3 --graph | dot -Tpng &gt;pacvis-pactree.png</code>
</div>
<div class="panel-body">
<img alt="pactree --graph" class="img-responsive" src="//farseerfc.me/en/images/pacvis-pactree.png"/>
</div>
</div>
<div class="highlight"><pre><span class="code-line"><span></span><span class="gp">$</span> pactree pacvis-git -d3</span>
<span class="code-line"><span class="go">pacvis-git</span></span>
<span class="code-line"><span class="go">├─python-tornado</span></span>
<span class="code-line"><span class="go">│ └─python</span></span>
<span class="code-line"><span class="go">│   ├─expat</span></span>
<span class="code-line"><span class="go">│   ├─bzip2</span></span>
<span class="code-line"><span class="go">│   ├─gdbm</span></span>
<span class="code-line"><span class="go">│   ├─openssl</span></span>
<span class="code-line"><span class="go">│   ├─libffi</span></span>
<span class="code-line"><span class="go">│   └─zlib</span></span>
<span class="code-line"><span class="go">├─pyalpm</span></span>
<span class="code-line"><span class="go">│ ├─python</span></span>
<span class="code-line"><span class="go">│ └─pacman</span></span>
<span class="code-line"><span class="go">│   ├─bash</span></span>
<span class="code-line"><span class="go">│   ├─glibc</span></span>
<span class="code-line"><span class="go">│   ├─libarchive</span></span>
<span class="code-line"><span class="go">│   ├─curl</span></span>
<span class="code-line"><span class="go">│   ├─gpgme</span></span>
<span class="code-line"><span class="go">│   ├─pacman-mirrorlist</span></span>
<span class="code-line"><span class="go">│   └─archlinux-keyring</span></span>
<span class="code-line"><span class="go">└─python-setuptools</span></span>
<span class="code-line"><span class="go">  └─python-packaging</span></span>
<span class="code-line"><span class="go">    ├─python-pyparsing</span></span>
<span class="code-line"><span class="go">    └─python-six</span></span>
<span class="code-line"><span class="gp"> $</span> pactree pacvis-git -d3 --graph <span class="p">|</span> dot -Tpng &gt;pacvis-pactree.png</span>
</pre></div>
<p>From the rendered diagram we can see that, because some packages may share
common dependencies, the whole diagram is no longer a
<a class="reference external" href="https://en.wikipedia.org/wiki/Tree_structure">tree in  graph theory</a> .
During the initial prototyping of PacVis, I tried to parse the output of pactree
and pacman using bash/python scripts, to draw a single diagram for the whole
system. However the rendered picture is so large that it takes hours for
dot to layout them, and the result is barely viewable in an image viewer or a
browser.</p>
<p>I need to say that there will be no PacVis if there is no pactree.
Even the pyalpm library that I used in PacVis is a python binding for alpm,
which is born during the rewrite of pactree in C language.</p>
</div>
<div class="section" id="pacgraph">
<h3><a class="toc-backref" href="#id5">pacgraph</a></h3>
<div class="panel panel-default">
<div class="panel-heading">
pacgraph 的輸出</div>
<div class="panel-body">
<img alt="pacgraph" class="img-responsive" src="//farseerfc.me/en/images/pacvis-pacgraph.png"/>
</div>
</div>
<p><a class="reference external" href="http://kmkeen.com/pacgraph/index.html">pacgraph</a> is developped by a
Arch Linux Trusted User <a class="reference external" href="http://kmkeen.com/">keenerd</a> . It is written
in Python, as is PacVis. Comparing with pactree, pacgraph is definitely more
suitable for my needs. It will draw a diagram for all the packages in the
system, using a clever layout algorithm that surpass the performance of
dot's layout.</p>
<p>The output of pacgraph is an artistic diagram with different font size of
package names showing their disk usage. By viewing pacgraph's output, we can
determine the overall system structure, e.g. whether the system is a desktop
system or a server. We can easily find large packages and consider remove them.</p>
<p>There's more. pacgraph provided an interactive GUI called pacgraph-tk, written
clearly in tk. You can zoom in to see details or zoom out to see the whole
graph in GUI, and you can highlight one package to see its relations to others.</p>
<p>And pacgraph support to render the dependencies of a selected group of packages,
not all, like pactree does.</p>
<p>But pacgraph does not meet all my needs. I want a diagram to show the
architecture of the system, but pacgraph don't differ
"the packages that this package depend on" and
"the packages that depends on this package". In other words, pacgraph draws a
<strong>undirected graph</strong>, but I want a <strong>directed graph</strong>, that reflects the
<strong>layered hierarchy of dependency relationship</strong>.</p>
</div>
</div>
<div class="section" id="so-here-is-pacvis">
<h2><a class="toc-backref" href="#id6">So here is PacVis</a></h2>
<div class="panel panel-default">
<div class="panel-heading">
PacVis on startup</div>
<div class="panel-body">
<img alt="PacVis on startup" class="img-responsive" src="//farseerfc.me/en/images/pacvis-second.png"/>
</div>
</div>
<p>With these predecessors, I started working on PacVis. The development takes
me 2 month, and largely break into 2 stages. In the first stage I wrote basic
logics and a prototype of the UI. In the second stage I applied the templates
from <a class="reference external" href="https://getmdl.io/">https://getmdl.io/</a> . Now finally it is usable for others.</p>
<p>So several days ago I made a PKGBUILD for pacvis on AUR:
<a class="reference external" href="https://aur.archlinux.org/packages/pacvis-git/">pacvis-git</a>.
Now it's fairly easy to run pacvis locally on a Arch Linux system.
You can use any aurhelper you familiar with, or build it directly from AUR:</p>
<div class="highlight"><pre><span class="code-line"><span></span><span class="go">~$ git clone aur@aur.archlinux.org:pacvis-git.git</span></span>
<span class="code-line"><span class="go">~$ cd pacvis-git</span></span>
<span class="code-line"><span class="go">~/pacvis-git$ makepkg -si</span></span>
<span class="code-line"><span class="go">~/pacvis-git$ pacvis</span></span>
<span class="code-line"><span class="go">Start PacVis at http://localhost:8888/</span></span>
</pre></div>
<p>Following the instruction, open <a class="reference external" href="http://localhost:8888/">http://localhost:8888/</a> in a browser then you can
see PacVis's result of your own system. As a demonstration you can also visit
PacVis on my Arch Linux server :
<a class="reference external" href="https://pacvis.farseerfc.me/">https://pacvis.farseerfc.me/</a> . It is showing a minimal server setup, that might
load and layout faster than a normal desktop system.</p>
</div>
<div class="section" id="the-legend-and-usage-of-pacvis">
<h2><a class="toc-backref" href="#id7">The legend and usage of PacVis</a></h2>
<p>PacVis resembles the UI of a map app such as Google Maps. You can use
wheel of mouse to zoom and drag to move, or pinch gestures on a touch screen.
There is a side panel on the right top corner and you can hide it when you don't
need it. There are some zoom buttons on the right bottom corner.</p>
<div class="figure">
<img alt="PacVis showing pacvis-git" class="img-responsive" src="//farseerfc.me/en/images/pacvis-pacvis-git.png"/>
<p class="caption">The dependencies of pacvis-git package</p>
</div>
<p>The whole diagram is made up of small circles and arrows in between circles.
A circle represent a package, while an arrow represents a dependency
relationship. If you zoom into details, you can see text under the circles
showing their package names. Hover on packages will also give you infos
about the package. You can select a package, and in the side panel there will be
more detailed infomation about that package.</p>
<p>The above picture is showing the dependencies of pacvis-git package itself.
It dependes on pyalpm, python-tornado and python-setuptools, while pyalpm
is in-turn depend on pacman.
A package in <span class="label label-primary">purple</span> means it is
installed manually, while a package in
<span class="label label-warning">orange</span> means it is installed
as a dependency for other packages. The color of arrows usually follow their
origin package's color.</p>
<p>Note that most arrows in the diagram are pointing bottom-up, this is because
PacVis will do a topology sort based on the dependencies of packages.
From the topology sort, PacVis assigned a <em>topology level</em> to each package,
e.g. pacvis-git has a topo-level of 39, its dependency pyalpm has a topo-level
of 38, and pacman is sat on the topo-level 37.
Layering packages with their topo-level is the main difference of PacVis with
pacgraph.</p>
<p>Besides manually zoom-in to look around, you can also use PacVis's search box
to locate a particular package by its name. And when you select a package,
the related package names will be shown in the Dep and Req-By tabs in the
sidebar. These package names are made as buttons so you can click them to
browse the whole dependency graph.</p>
<p>Let me describe some arguments related to the implementation:</p>
<div class="label label-info">
Max Level</div>
<p>This will limit the max topo-level that PacVis renders.
When there are too many packages, the layout algorithm will take a lot of time.
Limiting this is very useful during debug of PacVis.</p>
<div class="label label-info">
Max Required-By</div>
<p>This will limit the max required-by-relationship that PacVis renders.
If you play around in PacVis, you will soon find that most packages in the
system directly depends on glibc or gcc-libs. Rendering these <em>well-known</em>
dependency may result in a lot of long arrows, that reduce the readability of
the whole diagram. You can limit this to a lower number so that PacVis will
not render these <em>well-known</em> dependencies.</p>
</div>
<div class="section" id="some-facts-you-can-learn-from-pacvis">
<h2><a class="toc-backref" href="#id8">Some facts you can learn from PacVis</a></h2>
<div class="panel panel-default">
<div class="panel-heading">
PacVis's result of a KDE desktop PacVis <a class="reference external" href="//farseerfc.me/en/images/pacvis-16384.png">Full image（17M）</a></div>
<div class="panel-body">
<img alt="A normal KDE desktop in PacVis" class="img-responsive" src="//farseerfc.me/en/images/pacvis-4096-anno.png"/>
</div>
</div>
<p>You may find many facts by playing around in PacVis. An example will be the
aforementioned "most packages depends on glibc".
Besides that, I will give some more examples below.</p>
<div class="section" id="dependency-hierachy">
<h3><a class="toc-backref" href="#id9">Dependency hierachy</a></h3>
<p>The packages in the system is clearly divided into several layers:</p>
<ul class="simple">
<li>glibc, etc. C runtime</li>
<li>Bash/Perl/Python etc. script languages</li>
<li>coreutils/gcc/binutils etc. core binary utilities</li>
<li>pacman/systemd etc. large system utilities</li>
<li>gtk{2,3}/qt{4,5} etc. GUI toolkit</li>
<li>chromium etc. GUI Applications</li>
<li>Plasma/Gnome etc. Desktop environments</li>
</ul>
<p>This largely suit my overall understanding, but some details are interesting to
me. For example, zsh dependes on gdbm which in-turn depends on bash, which means
that you can not get rid of bash even if you only use zsh.
For another example, python package (which is python3 in Arch Linux) and
python2 and pypy sit roughly on the same topo-level in the diagram.</p>
<div class="figure">
<img alt="zsh indirectly depends on bash because of gdbm" class="img-responsive" src="//farseerfc.me/en/images/pacvis-zsh-bash.png" style="width: 45%;"/>
<p class="caption">zsh indirectly depends on bash because of gdbm</p>
</div>
<p>However there are some facts beyond common knowledge, e.g.
qt5-base &lt; qt4 &lt; gtk2 &lt; gtk3 with regard to topo-level.
Qt5 was split into several packages therefore it is understandable that
qt5-base is lower than qt4. The fact that gtk is more high level than qt
may beyond most expectations (including mine).</p>
</div>
<div class="section" id="circular-dependencies">
<h3><a class="toc-backref" href="#id10">Circular dependencies</a></h3>
<p>There are some packages that have circular dependencies in between.
An example will be freetype2 and harfbuzz. freetype2 is a library for font
rendering, and harfbuzz is a library to deal with OpenType font shapes.
They depend on each other. Another example is kio and kinit of KDE.
kio provides VFS-like and FUSE-like resource abstraction for KDE applications,
while kinit is in charge of initializing KDE desktop environment.</p>
<div class="figure">
<img alt="freetype2 harfbuzz" class="img-responsive" src="//farseerfc.me/en/images/pacvis-freetype2-harfbuzz.png" style="width: 45%;"/>
<p class="caption">Circular dependency between freetype2 and harfbuzz</p>
</div>
<p>Because of these circular dependencies, PacVis cannot simply apply topology sort
directly. Before that, PacVis will firstly find all circles in the dependency
graph to break these circles. It renders the relationship that will cause a
circle as red arrows in the diagram.</p>
</div>
<div class="section" id="some-packages-don-t-have-dependency-relationship">
<h3><a class="toc-backref" href="#id11">Some packages don't have dependency relationship</a></h3>
<div class="figure">
<img alt="PacVis Level 0" class="img-responsive" src="//farseerfc.me/en/images/pacvis-level0.png" style="width: 45%;"/>
<p class="caption">man-pages and licenses don't have dependencies</p>
</div>
<p>There are some packages that don't depend on others, and don't depended
by others. They are isolated in the whole diagram, e.g. man-pages and licenses.
These packages sit on the most top level of the diagram, with a topo-level of 0.
PacVis will render them as <span class="label label-info">blue</span>
squares specially.</p>
</div>
<div class="section" id="linux-the-kernel-is-unimportant-if-we-only-look-at-dependencies">
<h3><a class="toc-backref" href="#id12">Linux (the kernel) is unimportant, if we only look at dependencies</a></h3>
<p>All userspace program depend on glibc, which calls the kernel using well-defined
syscalls. As a result, if we only look at userspace dependencies, glibc and
other GNU components are the center of the GNU/Linux distribution, while
Linux the kernel is just located in a random place deeply blew the dependency
graph. On my demo server the Linux package is even located on the most bottom
level because it depends on mkinitcpio which in-turn depend on many components
in the system.</p>
</div>
</div>
<div class="section" id="the-future-of-pacvis">
<h2><a class="toc-backref" href="#id13">The future of PacVis</a></h2>
<p>Currently PacVis is what I planned to make, with some features added during
the development. Some of these added features are related to the poor
performance of the layout algorithm (e.g. limiting the max level).</p>
<p>In the future I planned to add more features:</p>
<ol class="arabic simple">
<li>More reasonable behavior for optdeps. Currently PacVis draw optdeps but do
not consider it during the topology sort.</li>
<li>More reasonable <strong>dependency resolution</strong>. Sometimes the dependency is not
written directly as package names, instead they appear in <code class="code">
provides</code>

array in the metadata. Currently PacVis resolve all dependencies using
alpm directly, which will lose these information.</li>
<li>Currently PacVis did not consider the repository (core/extra/community) and
package group that a package belongs to. In the future PacVis may consider
these infomation to render a clearer hierarchy.</li>
<li>Currently PacVis cannot show only part of the packages. In the future we may
provide the ability to draw only a part of all the installed packages like
pactree/pacgraph does.</li>
</ol>
<p>If you want some features in PacVis, please
<a class="reference external" href="https://github.com/farseerfc/pacvis/issues">leave me an issue</a> .</p>
</div>

            </div>
            <div class="entry-content jumbotron" id="source-content" style="display: none">
                <!-- <pre><code id="source-code">
                </code></pre> -->
                <div id="source-code"></div>
            </div>
            <!-- /.entry-content -->

            <div class="row" id="prevnext">
                <div class="col-xs-12">
                    <a href="//farseerfc.me/en/jumping-kde5-plasma-activities-button.html" class="btn btn-default btn-lg" style="float:left;clear:both;background-color:#fff;">
                        <h4><i class="fa fa-arrow-left"></i>
                        Jumping KDE5 Plasma Activities Button
                        </h4>
                    </a>
                </div>
                <div class="col-xs-12">
                </div>
            </div>


<section class="comments" id="comments">
    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
      <div class="panel panel-primary">
        <div class="panel-heading" role="tab" id="disqus-heading">
          <h4 class="panel-title">
            <a data-toggle="collapse" data-parent="#accordion" href="#disqus-comments" aria-expanded="true" aria-controls="disqus-comments">
              <i class="fa fa-comments-o"></i> Disqus comments            </a>
          </h4>
        </div>
        <div id="disqus-comments" class="panel-collapse collapse" role="tabpanel" aria-labelledby="disqus-heading">
          <div class="panel-body">
            <div class="tab-pane fade active in" id="disqus-comments">
                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'farseerfcgithub'; // required: replace example with your forum shortname

                            var disqus_identifier = 'pacvis';
                        var disqus_url = 'http://farseerfc.me/en/pacvis.html';

                    var disqus_config = function () {

                        this.language = "en";
                    };

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function () {
                        var dsq = document.createElement('script');
                        dsq.type = 'text/javascript';
                        dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
                    Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            </div>
          </div>
        </div>
      </div>
    </div>
</section>        </article>
    </section>


            </div>
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <a data-dismiss="modal" href="javascript:void(0);">
            <img id="mimg" src="" style="width:100%;height:auto">
          </a>
        </div>
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6" id="sidebar">
            <aside>

<section>
    <div class="sidebar-container">
<div class="sidebar-item ">
<div class="panel panel-default">
	<div class="panel-heading">
        <h4>
<i class="fa fa-user fa-lg"></i>
<a href="//farseerfc.me/en/about.html">
About farseerfc</a>
        </h4>
    </div>
<div class="panel-body" id="aboutme">
        <a href="//farseerfc.me/en/about.html"><img width="100%" src="//farseerfc.me/en/../images/avatar.jpg"/></a>
    <h3 style="text-align:center">
<a href="https://twitter.com/farseerfc"                  target="_blank">
<i class="fa fa-twitter" style="text-align:center"></i></a>
<a href="https://github.com/farseerfc"                   target="_blank">
<i class="fa fa-github" style="text-align:center"></i></a>
<a href="http://weibo.com/farseerfc"                     target="_blank">
<i class="fa fa-weibo" style="text-align:center"></i></a>
<a href="http://www.facebook.com/farseerfc"              target="_blank">
<i class="fa fa-facebook" style="text-align:center"></i></a>
<a href="https://plus.google.com/u/0/+JiachenYang/posts" target="_blank">
<i class="fa fa-google-plus" style="text-align:center"></i></a>
<a href="mailto:farseerfc@gmail.com" target="_blank">
<i class="mdi-communication-email" style="text-align:center"></i></a>
</h3>

</div>
</div>
</div>        



            

<div class="sidebar-item ">
<div class="panel panel-default">
	<div class="panel-heading">
        <h4>
<a href="//farseerfc.me/en/tags.html"><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></a>
        </h4>
    </div>
<div class="panel-body">
    <ul class="list-group list-inline tagcloud" id="tags">
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/pelican.html">
                    pelican <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/icse.html">
                    icse <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/gnome3.html">
                    gnome3 <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-1">
                <a href="//farseerfc.me/en/tag/linux.html">
                    linux <sup> 3</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/pacvis.html">
                    pacvis <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/arch.html">
                    arch <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/msr.html">
                    msr <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/kde5.html">
                    kde5 <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/pacgraph.html">
                    pacgraph <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/template.html">
                    template <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/music.html">
                    music <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/you.html">
                    you <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/plasma.html">
                    plasma <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/acpi.html">
                    acpi <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/mining.html">
                    mining <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/repository.html">
                    repository <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-1">
                <a href="//farseerfc.me/en/tag/python.html">
                    python <sup> 3</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/java.html">
                    java <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/ruby.html">
                    ruby <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/me.html">
                    me <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/c.html">
                    C <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/pacman.html">
                    pacman <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-2">
                <a href="//farseerfc.me/en/tag/microsoft.html">
                    microsoft <sup> 2</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/will.html">
                    will <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/marry.html">
                    marry <sup> 1</sup>
                </a>
            </li>
            <li class="list-group-item tag-4">
                <a href="//farseerfc.me/en/tag/software.html">
                    software <sup> 1</sup>
                </a>
            </li>
    </ul>
</div>
</div>
</div>

<div class="sidebar-item hidden-xs">
<div class="panel panel-default">
	<div class="panel-heading">
        <h4>
<i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span>
        </h4>
    </div>
    <div class="panel-body">
        <div id="gh_repos">
            <p class="list-group-item">Status updating...</p>
        </div>
            <a href="https://github.com/farseerfc">@farseerfc</a> on GitHub<br>
            <div style="margin:-10px" class="github-card" data-github="farseerfc" data-width="200" data-theme="medium"></div>
			<script src="//cdn.jsdelivr.net/github-cards/latest/widget.js"></script>
    </div>
</div>
</div>

    </div>
</section>
        <div class="panel panel-default hidden-xs hidden-sm" id="affix-toc">
            <div class="panel-heading"><h4>
Table of Contents</h4>
            </div>
            <div class="panel-boy">
            <div class="toc" id="">

<ul class="simple">
<li><a class="reference internal" href="#motivation-for-pacvis" id="id2">Motivation for PacVis</a></li>
<li><a class="reference internal" href="#predecessors-of-pacvis" id="id3">Predecessors of PacVis</a><ul>
<li><a class="reference internal" href="#pactree" id="id4">pactree</a></li>
<li><a class="reference internal" href="#pacgraph" id="id5">pacgraph</a></li>
</ul>
</li>
<li><a class="reference internal" href="#so-here-is-pacvis" id="id6">So here is PacVis</a></li>
<li><a class="reference internal" href="#the-legend-and-usage-of-pacvis" id="id7">The legend and usage of PacVis</a></li>
<li><a class="reference internal" href="#some-facts-you-can-learn-from-pacvis" id="id8">Some facts you can learn from PacVis</a><ul>
<li><a class="reference internal" href="#dependency-hierachy" id="id9">Dependency hierachy</a></li>
<li><a class="reference internal" href="#circular-dependencies" id="id10">Circular dependencies</a></li>
<li><a class="reference internal" href="#some-packages-don-t-have-dependency-relationship" id="id11">Some packages don't have dependency relationship</a></li>
<li><a class="reference internal" href="#linux-the-kernel-is-unimportant-if-we-only-look-at-dependencies" id="id12">Linux (the kernel) is unimportant, if we only look at dependencies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-future-of-pacvis" id="id13">The future of PacVis</a></li>
</ul>
</div>
            </div>
        </div>
            </aside>
        </div>
    </div>
</div>


<footer id="fcfooter">
   <hr/>
   <div class="container">
      <div class="row">
         <div class="col-md-24">
         <p><small>
            &copy; 2016 farseerfc
            &middot; Powered by            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a> generator                <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a>
    <!-- Content -->
  <!-- licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution 4.0 International License</a>, except where indicated otherwise. -->

         </small></p>
         </div>
      </div>
   </div>
   <a href="#" class="btn btn-primary btn-fab btn-raised mdi-editor-vertical-align-top withripple" style="position:fixed;bottom:30px;right:30px;z-index:1000"></a>
</footer>
<script src="//farseerfc.me/en/../theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="//farseerfc.me/en/../theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="//farseerfc.me/en/../theme/js/respond.min.js"></script>

    <!-- GitHub JS -->
    <script type="text/javascript">
        $(document).ready(function () {
            if (!window.jXHR) {
                var jxhr = document.createElement('script');
                jxhr.type = 'text/javascript';
                jxhr.src = '//farseerfc.me/en/../theme/js/jXHR.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(jxhr, s);
            }

            github.showRepos({
                user: 'farseerfc',
                count: 5,
                skip_forks: false,
                target: '#gh_repos'
            });
        });
    </script>
    <script src="//farseerfc.me/en/../theme/js/github.js" type="text/javascript"></script>
    <!-- End GitHub JS Code -->
    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'farseerfcgithub'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-29540705-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

<script src="//farseerfc.me/en/../theme/js/ripples.min.js"></script>
<script src="//farseerfc.me/en/../theme/js/material.min.js"></script>
<script src="//farseerfc.me/en/../theme/js/jquery.bootstrap-autohidingnavbar.min.js"></script>
<script>
    $(document).ready(function() {
        $.material.init();
        $("div.navbar").autoHidingNavbar();
        $(".img-responsive").css("cursor","pointer").on('click',function(){
            var sr=$(this).attr('src');
            $('#mimg').attr('src',sr);
            $('#myModal').modal('show');
        });
        $('#affix-toc').affix({
          offset: {
            top: function(){
                if($('#affix-toc').hasClass("affix"))
                    return $('#sidebar').height();
                return $('#sidebar').height() - $('#affix-toc').height();
            },
            bottom: function (){
                return $("#fcfooter").offset().top -
                    $("#article-content").offset().top -
                    $("#article-content").height() + 20;
            }
          }
        });
        $('#affix-toc').width($('#sidebar').width());
    });
    $(window).resize(function () {
       $('#affix-toc').width($('#sidebar').width());
    });
</script>

</body>
</html>